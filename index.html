<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#f0f0f0" id="theme-color-meta">
    <title>Matthew Ahn</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/ScrollToPlugin.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/ScrollSmoother.min.js"></script>
    <script src="global-clock-component.js"></script>
    <style>
        @font-face {
            font-family: 'Unica77LL';
            src: url('Unica77LLWeb-Medium.woff') format('woff');
            font-weight: 500;
            font-style: normal;
        }
        
        @font-face {
            font-family: 'Input';
            src: url('https://github.com/amachinic/Merem/raw/main/Input-Regular_(InputSansNarrow-Light).ttf') format('truetype');
            font-weight: 300;
            font-style: normal;
        }
        :root {
            --bg-color: #f0f0f0;
            --text-color: #2c2c2c;
            --secondary-text-color: #a0a0a0;
            --nav-bg-color: rgba(255, 255, 255, 0.15);
            --nav-border-color: rgba(255, 255, 255, 0.2);
            --nav-hover-color: rgba(0, 0, 0, 0.1);
            --clock-bg-color: #f0f0f0;
            --tooltip-bg-color: white;
            --tooltip-text-color: black;
            --shadow-color: rgba(0, 0, 0, 0.12);
            --toggle-border-color: rgba(0, 0, 0, 0.3);
            --light-nav-border-color: rgba(0, 0, 0, 0.15);
            --card-bg-color: #000;
            --card-text-color: #fff;
            
            /* Design System: Case Study Color Palette */
            --case-study-qa-framework: rgb(0, 5, 11); /* Obsidian */
            --case-study-design-system: rgb(8, 0, 11); /* Violet */
            --case-study-mobile-experience: rgb(0, 10, 5); /* Forest green */
            --case-study-ai-integration: rgb(14, 6, 0); /* Rouge */
        }

        [data-theme="dark"] {
            --bg-color: #0f0f0f;
            --text-color: #ffffff;
            --secondary-text-color: #888888;
            --nav-bg-color: rgba(255, 255, 255, 0.05);
            --nav-border-color: rgba(255, 255, 255, 0.15);
            --nav-hover-color: rgba(255, 255, 255, 0.2);
            --clock-bg-color: #0f0f0f;
            --tooltip-bg-color: #333;
            --tooltip-text-color: #ffffff;
            --shadow-color: rgba(0, 0, 0, 0.3);
            --toggle-border-color: rgba(255, 255, 255, 0.15);
            --light-nav-border-color: transparent;
            --card-bg-color: #1a1a1a;
            --card-text-color: #fff;
            
            /* Design System: Monochromatic Gradient Palette for Dark Mode */
            --case-study-qa-framework: rgb(22, 24, 28); /* Darkest gradient - sophisticated charcoal */
            --case-study-design-system: rgb(28, 30, 35); /* Dark-mid gradient - refined slate */
            --case-study-mobile-experience: rgb(35, 38, 42); /* Mid-light gradient - elegant graphite */
            --case-study-ai-integration: rgb(42, 45, 50); /* Lightest gradient - premium steel */
        }

        /* =================================
           TYPOGRAPHY SYSTEM
           ================================= */
        
        /* Typography Mapping Guide:
           - H1 (64px) = Major page titles
           - H2 (40px) = Section titles, project titles  
           - H3 (24px) = Subsection titles, problem questions
           - Body (16px) = General text, labels, team circles
           - Value (14px) = Meta values, form inputs, triage text
           - Caption (12px) = Pills, small labels, sublabels
        */
        
        /* Desktop & Tablet Typography (default) */
        .type-h1 {
            font-family: 'Unica77LL', Arial, sans-serif;
            font-size: 64px;
            font-weight: 500;
            line-height: 1.2;
        }
        
        .type-h2 {
            font-family: 'Unica77LL', Arial, sans-serif;
            font-size: 40px;
            font-weight: 500;
            line-height: 1.3;
        }
        
        .type-h3 {
            font-family: 'Unica77LL', Arial, sans-serif;
            font-size: 24px;
            font-weight: 400;
            line-height: 1.5;
        }
        
        .type-body {
            font-family: 'Unica77LL', Arial, sans-serif;
            font-size: 16px;
            font-weight: 400;
            line-height: 1.6;
        }
        
        .type-value {
            font-family: 'Unica77LL', Arial, sans-serif;
            font-size: 14px;
            font-weight: 400;
            line-height: 1.4;
        }
        
        .type-label,
        .type-caption {
            font-family: 'Unica77LL', Arial, sans-serif;
            font-size: 12px;
            font-weight: 400;
            line-height: 1.4;
        }
        
        /* Mobile Typography */
        @media (max-width: 768px) {
            .type-h1 {
                font-size: 40px;
            }
            
            .type-h2 {
                font-size: 32px;
            }
            
            .type-h3 {
                font-size: 20px;
            }
            
            .type-body {
                font-size: 14px;
            }
            
            .type-value {
                font-size: 13px;
            }
            
            .type-label,
            .type-caption {
                font-size: 11px;
            }
        }
        
        /* Extra Small Mobile Typography */
        @media (max-width: 480px) {
            .type-h1 {
                font-size: 32px;
            }
            
            .type-h2 {
                font-size: 28px;
            }
            
            .type-h3 {
                font-size: 18px;
            }
            
            .type-body {
                font-size: 14px;
            }
            
            .type-value {
                font-size: 12px;
            }
            
            .type-label,
            .type-caption {
                font-size: 10px;
            }
        }

        html {
            background-color: var(--bg-color);
        }

        body {
            -webkit-overflow-scrolling: touch; /* iOS smooth scrolling */
            overscroll-behavior: none; /* Prevent bounce on scroll boundaries */
        }

        /* Enhanced scroll performance */
        * {
            scroll-padding-top: 120px; /* Account for clock container */
        }

        /* Smooth momentum scrolling for webkit browsers */
        body, html {
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none; /* IE/Edge */
        }

        /* Hide default scrollbar */
        ::-webkit-scrollbar {
            width: 0px;
            background: transparent;
        }

        /* Firefox scrollbar */
        html {
            scrollbar-width: none;
        }



        body {
            font-family: 'Unica77LL', Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: background-color 0.3s ease, color 0.3s ease;
            overflow-x: hidden;
            opacity: 0;
            animation: fadeIn 1.5s ease-in-out forwards;
            min-height: 100vh;
        }

        /* Fade in animation */
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        /* Fade out animation for page transitions */
        body.fade-out {
            animation: fadeOut 0.8s ease-in-out forwards;
        }

        @keyframes fadeOut {
            from {
                opacity: 1;
            }
            to {
                opacity: 0;
            }
        }

        /* Dark mode fade overlay */
        .fade-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #0f0f0f;
            opacity: 0;
            z-index: 9999;
            pointer-events: none;
            transition: opacity 0.8s ease-in-out;
        }

        .fade-overlay.active {
            opacity: 1;
            pointer-events: auto;
        }

        /* Navigation state styling */
        .navigating {
            overflow: hidden;
        }

        .navigating .gallery-cta,
        .navigating .work-cta {
            pointer-events: none;
            opacity: 0.7;
        }
        #intro {
            cursor: default;
        }
        #intro span {
            display: inline-block;
        }
        #intro-greeting {
            font-size: 24px;
            line-height: 1.2;
            margin-bottom: 18px;
            display: block;
        }
        #intro-description {
            font-size: 18px;
            line-height: 1.2;
            white-space: pre-wrap;
        }
        .trailing-char {
            display: inline-block;
            color: var(--secondary-text-color);
            transition: opacity 0.3s ease;
        }
        .scrambled {
            color: var(--secondary-text-color);
            transition: color 0.1s ease;
        }




        /* Updated styles for the navigation bar */
        #nav-container {
            position: fixed;
            bottom: 30px;
            left: 50%;
            top: auto;
            transform: translateX(-50%);
            z-index: 1001;
            transition: background-color 0.3s ease, backdrop-filter 0.3s ease, box-shadow 0.3s ease;
        }

        #nav-bar {
            display: flex;
            gap: 10px;
            border-radius: 12px;
            padding: 6px 10px;
            position: relative;
        }

        .nav-button {
            background: none;
            border: none;
            color: #161616ef;
            font-family: 'Input', monospace;
            font-size: 14px;
            font-weight: 500;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s ease, color 0.3s ease;
            position: relative;
            z-index: 2;
            text-decoration: none;
            letter-spacing: -0.01em;
        }

        
        [data-theme="dark"] .nav-button {
      
            color: #ffffffb2;
        }

        /* Navigation slider indicator */
        #nav-slider {
            position: absolute;
            top: 6px;
            bottom: 6px;
            background-color: var(--nav-hover-color);
            border-radius: 8px;
            transition: left 0.3s ease, width 0.3s ease;
            z-index: 1;
            pointer-events: none;
        }

        /* Updated styles for the blur effect with drop shadow */
        .blur-bg {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgb(255 255 255 / 60%);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(3px);
            border-radius: 12px;
            z-index: 1;
            border: 1px solid var(--nav-border-color);
            transition: box-shadow 0.3s ease, background-color 0.3s ease, border-color 0.3s ease;
        }

        /* Navigation bar specific border for light mode */
        #nav-container .blur-bg {
            border: 1px solid var(--light-nav-border-color);
        }

        /* Dark mode navigation bar background */
        [data-theme="dark"] #nav-container .blur-bg {
            background-color: rgb(255 255 255 / 10%);
        }
        /* Responsive adjustments for mobile */
        @media (max-width: 600px) {
            #nav-container {
                bottom: 20px;
                left: 50%;
                transform: translateX(-50%);
                width: auto;
                padding: 0;
            }
            #nav-bar {
                gap: 4px;
                padding: 6px;
                width: auto;
                display: flex;
                justify-content: center;
            }
            .nav-button {
                font-size: 13px;
                padding: 7px 10px;
                white-space: nowrap;
            }
            .blur-bg {
                border-radius: 8px;
            }
        }



        /* Section styles */
        .section {
            min-height: auto;
            padding: 60px 0;
            margin-bottom: 0;
            box-sizing: border-box;
        }

        /* Archive section removed */

        #home {
            padding: 140px 0 120px 0;
        }

        .section-content {
            width: 100%;
            margin: 0;
            padding: 0 40px;
            box-sizing: border-box;
            min-height: 0; /* Ensure consistent height calculation */
        }

        /* Section h2 extends H1 typography */
        .section h2 {
            font-size: 64px; /* type-h1 */
            margin-bottom: 60px;
            font-weight: 500;
        }

        /* Card styles */
        .card-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 24px;
            margin-bottom: 40px;
            min-height: 0; /* Prevent height calculation shifts */
        }

        .card {
            background-color: var(--card-bg-color);
            color: var(--card-text-color);
            border-radius: 8px;
            padding: 40px;
            transition: transform 0.3s ease, box-shadow 0.3s ease, background-color 0.3s ease;
            border: 1px solid transparent;
            will-change: transform, opacity;
        }

        /* Ensure tall-card has same base background as gallery-slide for consistent color appearance */
        .card.tall-card {
            background-color: var(--card-bg-color);
        }

        /* Case study cards use individual color scheme - see CSS rules below */

        .card:hover {
            box-shadow: 0 12px 40px var(--shadow-color);
        }

        /* Section title styling for typing animation */
        .section-title {
            transition: color 0.3s ease;
            min-height: 1.2em;
            line-height: 1.2;
            display: inline-block;
            width: fit-content;
            cursor: default;
            letter-spacing: -0.04em;
            will-change: opacity;
            opacity: 0;
        }



        .section-title span {
            transition: color 0.15s ease;
            cursor: default;
        }

        /* Card h3 extends H3 typography */
        .card h3 {
            font-size: 24px; /* type-h3 */
            margin-bottom: 16px;
            font-weight: 500;
        }

        /* Card p extends body typography */
        .card p {
            font-size: 16px; /* type-body */
            line-height: 1.6;
            margin-bottom: 24px;
            opacity: 0.9;
        }

        /* Multi-column layouts */
        .card-grid.two-columns {
            grid-template-columns: 1fr 1fr;
        }

        .card-grid.three-columns {
            grid-template-columns: repeat(3, 1fr);
        }

        .card-grid.four-columns {
            grid-template-columns: repeat(4, 1fr);
        }

        .card.tall-card {
            min-height: 280px;
            position: relative;
            overflow: hidden;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            align-items: flex-start;
            padding: 20px;
            text-align: left;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card.tall-card[onclick] {
            cursor: pointer;
        }

        .card.tall-card[onclick]:hover {
            transform: translateY(-2px);
        }

        /* Work section card content styling (matches gallery exactly) */
        .card.tall-card h3 {
            font-family: 'Input', monospace;
            font-size: 12px;
            margin: 0 0 8px 0;
            font-weight: normal;
            color: var(--card-text-color);
            opacity: 0;
            transform: translateX(-20px);
            transition: opacity 0.4s ease, transform 0.4s ease;
        }

        .card.tall-card p {
            font-family: 'Input', monospace;
            font-size: 12px;
            margin: 0;
            line-height: 1.4;
            color: var(--card-text-color);
            opacity: 0;
            transform: translateX(-20px);
            transition: opacity 0.4s ease, transform 0.4s ease;
            max-width: 350px;
        }

        /* Desktop hover animation for work cards */
        @media (min-width: 769px) {
            .card.tall-card:hover h3 {
                opacity: 1;
                transform: translateX(0);
            }

            .card.tall-card:hover p {
                opacity: 0.8;
                transform: translateX(0);
            }

            .card.tall-card:hover .work-cta {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Mobile adjustments - hide text but show work CTA */
        @media (max-width: 768px) {
            .card.tall-card h3,
            .card.tall-card p {
                display: none; /* Hide text on mobile */
            }
            
            /* Work CTA mobile positioning (hidden by default) */
            .work-cta {
                top: 15px;
                right: 15px;
                padding: 10px 18px; /* Slightly larger for touch */
            }
            
            /* Mobile hover states for work cards */
            .card.tall-card:hover .work-cta {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Individual Case Study Card Backgrounds - Applied with maximum specificity */
        .card-grid .card.tall-card:nth-child(1),
        .gallery-slides .gallery-slide:nth-child(1) {
            background-color: var(--case-study-qa-framework) !important;
        }

        .card-grid .card.tall-card:nth-child(2),
        .gallery-slides .gallery-slide:nth-child(2) {
            background-color: var(--case-study-design-system) !important;
        }

        .card-grid .card.tall-card:nth-child(3),
        .gallery-slides .gallery-slide:nth-child(3) {
            background-color: var(--case-study-mobile-experience) !important;
        }

        .card-grid .card.tall-card:nth-child(4),
        .gallery-slides .gallery-slide:nth-child(4) {
            background-color: var(--case-study-ai-integration) !important;
        }

        /* Extra specificity for work cards to ensure colors are applied */
        #work .card-grid .card.tall-card:nth-child(1) {
            background-color: var(--case-study-qa-framework) !important;
        }

        #work .card-grid .card.tall-card:nth-child(2) {
            background-color: var(--case-study-design-system) !important;
        }

        #work .card-grid .card.tall-card:nth-child(3) {
            background-color: var(--case-study-mobile-experience) !important;
        }

        #work .card-grid .card.tall-card:nth-child(4) {
            background-color: var(--case-study-ai-integration) !important;
        }

        .card.featured {
            grid-column: 1 / -1;
            padding: 60px 40px;
        }

        .card.half-height {
            min-height: 200px;
        }

        .card.tall {
            min-height: 400px;
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .section-content {
                padding: 0 20px;
                box-sizing: border-box;
            }

            .section h2 {
                font-size: 36px;
                margin-bottom: 40px;
            }

            .card-grid.two-columns,
            .card-grid.three-columns,
            .card-grid.four-columns {
                grid-template-columns: 1fr;
            }

            .card.tall-card {
                min-height: 200px;
            }

            .card {
                padding: 24px;
            }

            .card.featured {
                padding: 40px 24px;
            }

            body {
                padding: 0;
            }

            #home {
                padding-top: 120px;
            }

        }

        /* Home section vertical layout */
        #home .section-content {
            display: flex;
            flex-direction: column;
        }

        #intro-column {
            width: 100%;
            margin-bottom: 40px;
        }

        #gallery-column {
            width: 100%;
            display: flex;
            justify-content: flex-end;
        }

        .gallery-wrapper {
            width: 100%;
            display: flex;
            flex-direction: column;
        }

        /* Gallery card styles */
        .gallery-card {
            background-color: var(--card-bg-color);
            border-radius: 8px;
            overflow: hidden;
            position: relative;
            height: 58vh;
            width: 100%;
            will-change: transform, opacity;
        }

        .gallery-container {
            position: relative;
            width: 100%;
            height: 100%;
            perspective: 1000px;
        }

        .gallery-slides {
            position: relative;
            width: 100%;
            height: 100%;
        }

        .gallery-slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 40px;
            box-sizing: border-box;
            text-align: center;
            background-color: var(--card-bg-color);
            border-radius: 8px;
            transition: transform 0.6s ease-in-out, opacity 0.6s ease-in-out, z-index 0s linear 0.3s;
            transform-style: preserve-3d;
        }

        /* Simple card layout - no parallax */
        .gallery-slide {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            align-items: flex-start;
            padding: 20px;
            text-align: left;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }



        /* Active card - fully visible */
        .gallery-slide.active {
            opacity: 1;
            visibility: visible;
        }

        /* Gallery slides use the CSS variables defined above for consistent theming */

        .gallery-slide h3 {
            color: var(--card-text-color);
            font-size: 28px;
            margin-bottom: 20px;
            line-height: 1.2;
        }

        .gallery-slide p {
            color: var(--card-text-color);
            font-size: 16px;
            line-height: 1.5;
            opacity: 0.8;
            max-width: 300px;
        }

        /* Gallery arrow navigation */
        .gallery-arrows {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            opacity: 0;
            z-index: 20;
        }

        .gallery-card:hover .gallery-arrows {
            animation: arrowsDelayedEntry 0.3s ease forwards;
        }

        @keyframes arrowsDelayedEntry {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Prevent animation conflicts */
        .gallery-arrows {
            animation-fill-mode: both;
        }

        .gallery-card:not(:hover) .gallery-arrows {
            opacity: 0;
            animation: none;
        }

        .gallery-arrow {
            position: absolute;
            top: 20px;
            width: 116px;
            height: 48px;
            border-radius: 8px;
            background: transparent;
            border: 1px solid rgba(240, 240, 240, 1);
            color: rgba(240, 240, 240, 1);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s ease-in, border-color 0.2s ease-in, color 0.2s ease-in;
            pointer-events: auto;
            overflow: hidden;
            will-change: transform;
        }

        .gallery-arrow::before {
            content: '';
            position: absolute;
            width: 0;
            height: 1px;
            background-color: currentColor;
            top: calc(50% - 0.5px);
            opacity: 0;
            transition: all 0.2s ease-in;
            will-change: width, opacity;
            border-radius: 0.5px;
        }

        .gallery-arrow svg {
            position: relative;
            z-index: 5;
            transition: transform 0.2s ease-in;
            will-change: transform;
            pointer-events: none;
            display: block;
        }

        .gallery-arrow:hover {
            background-color: rgba(240, 240, 240, 0.1);
            border-color: rgba(240, 240, 240, .6);
            color: rgba(240, 240, 240, .6);
        }

        /* Ensure stable hover area - prevent flickering */
        .gallery-arrow::after {
            content: '';
            position: absolute;
            top: -10px;
            left: -10px;
            right: -10px;
            bottom: -10px;
            z-index: 10;
            pointer-events: auto;
        }



        .gallery-arrow-left {
            left: 20px;
        }

        .gallery-arrow-left::before {
            left: 50%;
            transform-origin: left center;
        }

        .gallery-arrow-left:hover::before {
            width: 40px;
            opacity: 1;
            left: 34%;
        }

        .gallery-arrow-left:hover svg {
            transform: translateX(-12px);
        }

        .gallery-arrow-right {
            right: 20px;
        }

        .gallery-arrow-right::before {
            right: 50%;
            transform-origin: right center;
        }

        .gallery-arrow-right:hover::before {
            width: 40px;
            opacity: 1;
            right: 34%;
        }

        .gallery-arrow-right:hover svg {
            transform: translateX(12px);
        }

        /* Gallery card content styling */
        .gallery-slide h3 {
            font-family: 'Input', monospace;
            font-size: 12px;
            margin: 0 0 8px 0;
            font-weight: normal;
            color: var(--card-text-color);
            opacity: 0;
            transform: translateX(-20px);
            transition: opacity 0.4s ease, transform 0.4s ease;
        }

        .gallery-slide p {
            font-family: 'Input', monospace;
            font-size: 12px;
            margin: 0 0 16px 0;
            line-height: 1.4;
            color: var(--card-text-color);
            opacity: 0;
            transform: translateX(-20px);
            transition: opacity 0.4s ease, transform 0.4s ease;
            max-width: 350px; /* Expanded for better readability - allows 5-6 words per line */
        }

        /* Gallery CTA extends caption typography */
        .gallery-cta {
            font-family: 'Input', monospace;
            font-size: 12px; /* type-caption */
            padding: 8px 16px;
            background: transparent;
            border: 1px solid rgba(240, 240, 240, 1);
            color: rgba(240, 240, 240, 1);
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s ease-in, border-color 0.2s ease-in, color 0.2s ease-in;
            opacity: 0;
            position: absolute;
            top: 44px; /* Arrow center: 20px (top) + 24px (half of 48px height) = 44px */
            left: 50%;
            transform: translate(-50%, -50%);
            will-change: transform;
            white-space: nowrap; /* Prevent text wrapping */
        }

        /* First card CTA starts in final position */
        .gallery-slide:first-child .gallery-cta {
            transform: translate(-50%, -50%);
            transition: background-color 0.2s ease-in, border-color 0.2s ease-in, color 0.2s ease-in, opacity 0.4s ease, transform 0.4s ease;
        }

        /* First card CTA gets offset when gallery is not hovered */
        .gallery-card:not(:hover) .gallery-slide:first-child .gallery-cta {
            transform: translate(-50%, -50%) translateY(-10px);
        }

        /* Cards 2-4 are static but fade with hover */
        .gallery-slide:not(:first-child) .gallery-cta {
            opacity: 0;
            transform: translate(-50%, -50%);
            transition: background-color 0.2s ease-in, border-color 0.2s ease-in, color 0.2s ease-in, opacity 0.3s ease;
        }

        .gallery-cta:hover {
            background: transparent;
            border: 1px solid rgba(240, 240, 240, 1);
            color: rgba(240, 240, 240, 1);
        }

        /* Work section CTA styling - extends caption typography */
        .work-cta {
            font-family: 'Input', monospace;
            font-size: 12px; /* type-caption */
            padding: 8px 16px;
            border: 1px solid rgba(255, 255, 255, 0.24);
            background: transparent;
            color: rgba(255, 255, 255, 0.8);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease-in;
            opacity: 0;
            margin-top: 16px;
            align-self: flex-start;
            will-change: transform;
            white-space: nowrap; /* Prevent text wrapping */
        }

        .work-cta:hover {
            background-color: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.6);
            color: rgba(255, 255, 255, 1);
        }

        /* Archive search styles removed */

        

        /* Archive styles removed */

        

        

        

        

        .search-button {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            width: 40px;
            height: 40px;
            border: none;
            background: transparent;
            color: var(--secondary-text-color);
            cursor: pointer;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s ease, color 0.2s ease;
        }

        .search-button:hover {
            background-color: var(--nav-hover-color);
            color: var(--text-color);
        }

        

        .suggestion-tag {
            padding: 8px 16px;
            border: 1px solid var(--toggle-border-color);
            border-radius: 20px;
            background: transparent;
            color: var(--secondary-text-color);
            font-family: 'Input', monospace;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .suggestion-tag:hover {
            border-color: var(--text-color);
            color: var(--text-color);
            background-color: var(--nav-hover-color);
        }

        /* Mobile adjustments for search */
        @media (max-width: 768px) {
            .search-container {
                max-width: 100%;
                padding: 0 20px;
            }

            

            .search-button {
                width: 36px;
                height: 36px;
                right: 6px;
            }

            .suggestion-tag {
                font-size: 11px;
                padding: 6px 12px;
            }
        }

        /* Contact section styling */
        .contact-container {
            display: flex;
            justify-content: center;
            align-items: start;
            opacity: 0;
            transform: translateY(30px);
            will-change: transform, opacity;
            margin-bottom: 60px;
        }

        .contact-form-card {
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 12px;
            padding: 60px;
            width: 100%;
            max-width: 1000px;
            box-sizing: border-box;
            border: 1px solid var(--toggle-border-color);
        }

        [data-theme="dark"] .contact-form-card {
            background-color: rgba(35, 35, 35, 0.9);
            border: 1px solid var(--toggle-border-color);
        }



        .contact-form {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 40px;
            align-items: start;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        /* Form label extends caption typography */
        .form-group label {
            font-family: 'Input', monospace;
            font-size: 12px; /* type-caption */
            color: var(--text-color);
            font-weight: 500;
        }

        .form-group input[type="text"],
        .form-group input[type="email"],
        .form-group input[type="tel"] {
            width: 100%;
            height: 48px;
            padding: 12px 16px;
            border: 1px solid var(--toggle-border-color);
            border-radius: 8px;
            background-color: #FFFFFF;
            color: var(--text-color);
            font-family: 'Unica77LL', Arial, sans-serif;
            font-size: 15px;
            outline: none;
            transition: border-color 0.3s ease, box-shadow 0.3s ease, background-color 0.3s ease;
            box-sizing: border-box;
        }

        .form-group input::placeholder {
            color: var(--secondary-text-color);
        }

        .form-group input:hover {
            border-color: rgba(100, 100, 100, 0.4);
            background-color: rgba(250, 250, 250, 1);
        }

        .form-group input:focus {
            border-color: var(--text-color);
            box-shadow: 0 0 0 1px var(--text-color);
            background-color: #FFFFFF;
        }

        [data-theme="dark"] .form-group input[type="text"],
        [data-theme="dark"] .form-group input[type="email"],
        [data-theme="dark"] .form-group input[type="tel"] {
            background-color: rgba(255, 255, 255, 0.95);
            color: #333;
        }

        /* dark mode removed */



        /* Drag-to-send toggle styling */
        .send-toggle-container {
            margin-top: 24px;
            width: 100%;
            display: flex;
            justify-content: center;
        }

        .send-toggle-track {
            position: relative;
            width: 200px;
            height: 100px;
            background: rgba(250, 250, 250, 1);
            border-radius: 80px;
            border: 1px solid var(--toggle-border-color);
            box-shadow: inset -2px 4px 4px rgb(59 58 58 / 5%), inset 7px 4px 4px rgb(65 65 65 / 5%);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            transition: all 0.3s ease;
            cursor: pointer;
        }



        .send-toggle-thumb {
            position: absolute;
            left: 0; /* Will be positioned by JavaScript */
            top: calc((100% - 76px) / 2); /* Always vertically centered */
            width: 76px;
            height: 76px;
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 50%, #e9ecef 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 2;
            box-shadow: 
            4px 2px 8px rgba(0, 0, 0, 0.15), 
            0px 4px 8px rgba(0, 0, 0, 0.1), 
            inset 6px 2px 0 rgba(255, 255, 255, 0.8), 
            inset -1px -1px 0 rgba(0, 0, 0, 0.05);
            color: var(--secondary-text-color);
            border: 0.5px solid rgba(0, 0, 0, 0.08);
        }

        .send-toggle-thumb:active {
            cursor: grabbing;
            transform: scale(1.05);
        }

        .send-toggle-thumb.active {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 50%, #e9ecef 100%);
            box-shadow: 
            4px 2px 8px rgba(0, 0, 0, 0.15), 
            0px 4px 8px rgba(0, 0, 0, 0.1), 
            inset 6px 2px 0 rgba(255, 255, 255, 0.8), 
            inset -1px -1px 0 rgba(0, 0, 0, 0.05);
            border: 0.5px solid rgba(0, 0, 0, 0.08);
        }

        .send-toggle-text {
            font-family: 'Input', monospace;
            font-size: 13px;
            color: var(--text-color);
            user-select: none;
            pointer-events: none;
            opacity: 0.7;
            transition: opacity 0.3s ease;
        }

        .send-toggle-track.sending .send-toggle-text {
            opacity: 0;
        }



        /* dark mode removed */



        .canvas-container {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 16px;
        }

        #drawing-canvas,
        #drawing-canvas-desktop {
            background-color: white;
            border-radius: 8px;
            border: 1px solid var(--toggle-border-color);
            cursor: url("data:image/svg+xml,%3csvg width='18' height='18' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M14.5 1.5l2 2-10 10-3 1 1-3 10-10z' fill='none' stroke='%23555' stroke-width='1' stroke-linecap='round' stroke-linejoin='round'/%3e%3cpath d='M11.5 4.5l2 2' stroke='%23555' stroke-width='1' stroke-linecap='round'/%3e%3cpath d='M2.5 16.5h2' stroke='%23333' stroke-width='1.5' stroke-linecap='round'/%3e%3c/svg%3e") 2 16, crosshair;
            transition: border-color 0.3s ease;
            position: relative;
        }

        #drawing-canvas {
            width: 320px;
            max-width: 100%;
            height: 200px;
        }

        #drawing-canvas-desktop {
            width: 280px;
            height: 280px;
        }

        #drawing-canvas:focus,
        #drawing-canvas-desktop:focus {
            border-color: var(--text-color);
            outline: none;
        }

        .canvas-controls {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 10;
        }

        .trash-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            pointer-events: auto;
        }

        .brush-controls {
            position: absolute;
            bottom: 8px;
            right: 8px;
            pointer-events: auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            height: 160px;
            padding: 12px 4px;
            border: 1px solid var(--toggle-border-color);
            border-radius: 6px;
            background-color: rgba(255, 255, 255, 0.95);
            transition: all 0.2s ease;
            cursor: default;
        }

        .brush-controls:hover,
        .brush-controls:active {
            background-color: rgba(240, 240, 240, 0.4);
            border-color: var(--text-color);
        }

        /* dark mode removed */

        .trash-btn {
            width: 32px;
            height: 32px;
            padding: 8px;
            border: 1px solid var(--toggle-border-color);
            border-radius: 6px;
            background-color: rgba(255, 255, 255, 0.95);
            color: var(--secondary-text-color);
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .trash-btn:hover {
            background-color: rgba(240, 240, 240, 0.4);
            border-color: var(--text-color);
            color: var(--text-color);
        }

        [data-theme="dark"] .trash-btn {
            background-color: rgba(35, 35, 35, 0.95);
        }

        [data-theme="dark"] .trash-btn:hover {
            background-color: rgba(35, 35, 35, 0.8);
            border-color: rgba(150, 150, 150, 0.6);
        }



        .brush-slider.vertical {
            width: 3px;
            height: 160px;
            background: var(--toggle-border-color);
            border-radius: 2px;
            outline: none;
            border: none;
            cursor: pointer;
            writing-mode: bt-lr; /* IE */
            -webkit-appearance: slider-vertical; /* WebKit */
            appearance: slider-vertical;
        }

        .brush-slider.vertical:focus {
            outline: none;
            box-shadow: none;
        }

        .brush-slider.vertical::-webkit-slider-thumb {
            appearance: none;
            width: 12px;
            height: 12px;
            background: var(--text-color);
            border-radius: 50%;
            cursor: pointer;
        }

        .brush-slider.vertical::-moz-range-thumb {
            width: 12px;
            height: 12px;
            background: var(--text-color);
            border-radius: 50%;
            cursor: pointer;
            border: none;
        }

        .brush-label {
            font-family: 'Input', monospace;
            padding: 8px 0px 0px 0px;
            font-size: 9px;
            color: var(--secondary-text-color);
            white-space: nowrap;
            writing-mode: horizontal-tb;
        }

        /* Canvas form group styling */

        .canvas-form-group label {
            font-family: 'Input', monospace;
            font-size: 12px;
            color: var(--text-color);
            font-weight: 500;
            display: block;
        }

        .canvas-form-group .canvas-container {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            gap: 12px;
        }

        /* Canvas visibility controls */
        .canvas-form-group {
            display: none; /* Hidden on desktop */
        }

        .desktop-canvas-field {
            display: block; /* Shown on desktop */
        }

        /* Hide mobile toggle container on desktop */
        .mobile-toggle-container {
            display: none;
        }

        /* Show desktop toggle container on desktop */
        .desktop-toggle-container {
            display: block;
        }

        /* Form column styling */
        .form-inputs-column {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .canvas-column {
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
        }

        .toggle-column {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        /* Desktop canvas field styling */
        .desktop-canvas-field {
            margin-bottom: 0;
        }

        .desktop-canvas-field label {
            font-family: 'Input', monospace;
            font-size: 12px;
            color: var(--text-color);
            font-weight: 500;
            margin-bottom: 8px;
            display: block;
        }

        .desktop-canvas-field .canvas-container {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 16px;
        }

        /* Mobile adjustments for contact */
        @media (max-width: 768px) {
            /* Show canvas form group on mobile */
            .canvas-form-group {
                display: block !important;
                width: 100%;
            }

            .contact-container {
                grid-template-columns: 1fr;
                gap: 0;
                display: block;
                margin-bottom: 60px;
            }

            .contact-form-card {
                padding: 40px 24px;
                margin: 0;
                border-radius: 12px;
                width: 100%;
                box-sizing: border-box;
            }

            /* Mobile form layout - single column (restore original) */
            .contact-form {
                display: flex;
                flex-direction: column;
                gap: 27px;
            }

            /* Hide desktop columns on mobile */
            .canvas-column {
                display: none;
            }

            .toggle-column {
                display: none;
            }
            
            .form-inputs-column {
                display: contents;
            }

            /* Full width input fields on mobile */
            .contact-form-card .form-group {
                display: flex;
                flex-direction: column;
                align-items: flex-start;
                width: 100%;
            }

            .contact-form-card .form-group input {
                width: 100% !important;
                max-width: none !important;
                box-sizing: border-box;
            }
            
            /* Ensure form inputs column takes full width */
            .form-inputs-column {
                width: 100%;
            }

            .send-toggle-container {
                margin-top: 20px;
            }

            .send-toggle-track {
                width: 100%;
                max-width: 200px;
                height: 100px;
            }

            .send-toggle-thumb {
                width: 76px;
                height: 76px;
                left: 0; /* Will be positioned by JavaScript */
                top: calc((100% - 76px) / 2); /* Maintain vertical centering on mobile */
            }

            .send-toggle-text {
                font-size: 12px;
            }

            /* Hide desktop canvas on mobile */
            .desktop-canvas-field {
                display: none;
            }

            /* Hide desktop toggle container on mobile, show mobile toggle */
            .desktop-toggle-container {
                display: none !important;
            }

            .mobile-toggle-container {
                display: block !important;
                width: 100%;
                margin-top: 20px;
            }

            /* Mobile canvas styling */
            .canvas-form-group #drawing-canvas {
                width: 100%;
                height: 180px;
            }

            .canvas-form-group .canvas-container {
                align-items: flex-start;
                width: 100%;
                margin-top: 8px;
            }

            .canvas-form-group .canvas-controls {
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                pointer-events: none;
                z-index: 10;
            }

            .canvas-form-group .trash-btn {
                position: absolute;
                top: 8px;
                right: 8px;
                pointer-events: auto;
            }

            .canvas-form-group .brush-controls {
                position: absolute;
                bottom: 8px;
                right: 8px;
                pointer-events: auto;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: space-between;
                width: 32px;
                height: 80px;
                padding: 8px 0;
                border: 1px solid var(--toggle-border-color);
                border-radius: 6px;
                background-color: rgba(255, 255, 255, 0.95);
                transition: all 0.2s ease;
                cursor: default;
            }

            .canvas-form-group .brush-controls:hover,
            .canvas-form-group .brush-controls:active {
                background-color: rgba(240, 240, 240, 0.4);
                border-color: var(--text-color);
            }

            .canvas-form-group .brush-slider.vertical {
                width: 3px !important;
                height: 60px;
                background: var(--toggle-border-color);
                border-radius: 2px;
                outline: none;
                border: none;
                cursor: pointer;
                writing-mode: bt-lr;
                -webkit-appearance: slider-vertical;
                appearance: slider-vertical;
            }

            .canvas-form-group .brush-slider.vertical:focus {
                outline: none;
                box-shadow: none;
            }

            .canvas-form-group .brush-slider.vertical::-webkit-slider-thumb {
                appearance: none;
                width: 12px;
                height: 12px;
                background: var(--text-color);
                border-radius: 50%;
                cursor: pointer;
            }

            .canvas-form-group .brush-slider.vertical::-moz-range-thumb {
                width: 12px;
                height: 12px;
                background: var(--text-color);
                border-radius: 50%;
                cursor: pointer;
                border: none;
            }

            .canvas-form-group .brush-label {
                font-size: 8px;
            }

            /* dark mode removed */
        }

        /* Desktop hover animation */
        @media (min-width: 769px) {
            /* Desktop CTA dimensions - width adjusted for text */
            .gallery-cta {
                width: 180px; /* Increased width to fit "Explore project" on one line */
                height: 48px; /* Match arrow icon height */
                padding: 14px 16px; /* Adjusted padding to match 48px height */
                display: flex;
                align-items: center;
                justify-content: center;
                white-space: nowrap; /* Prevent text wrapping */
            }

            .gallery-card:hover .gallery-slide.active h3 {
                opacity: 1;
                transform: translateX(0);
            }

            .gallery-card:hover .gallery-slide.active p {
                opacity: 0.8;
                transform: translateX(0);
            }

            /* First card CTA: movement + fade animation */
            .gallery-card:hover .gallery-slide.active:first-child .gallery-cta {
                opacity: 1;
                transform: translate(-50%, -50%);
            }

            /* Other cards CTA: fade in on hover (static position) */
            .gallery-card:hover .gallery-slide.active:not(:first-child) .gallery-cta {
                opacity: 1;
            }
        }

        /* Mobile adjustments - hide text but show CTA */
        @media (max-width: 768px) {
            .gallery-slide h3,
            .gallery-slide p {
                display: none; /* Hide text on mobile */
            }
            
            /* Gallery CTA mobile sizing and positioning */
            .gallery-cta {
                padding: 10px 18px; /* Slightly larger for touch */
                top: 38px; /* Arrow center: 20px (top) + 18px (half of 36px height) = 38px */
            }

            /* First card uses same base position - translateY handles the offset */
            
            /* Mobile hover states for gallery */
            /* First card CTA: movement + fade animation */
            .gallery-card:hover .gallery-slide.active:first-child .gallery-cta {
                opacity: 1;
                transform: translate(-50%, -50%);
            }

            /* Other cards CTA: fade in on hover (static position) */
            .gallery-card:hover .gallery-slide.active:not(:first-child) .gallery-cta {
                opacity: 1;
            }
            
            /* Adjust arrow size on mobile to match CTA height */
            .gallery-arrow {
                width: 80px; /* Reduced from 116px */
                height: 36px; /* Match actual CTA rendered height */
            }
            
            /* Smaller chevron icons for mobile arrows */
            .gallery-arrow svg {
                width: 32px; /* Reduced from 48px */
                height: 32px; /* Reduced from 48px */
            }
            
            /* Adjust line positioning for mobile width */
            .gallery-arrow-left:hover::before {
                left: 30%; /* Closer connection for narrower button */
            }
            
            .gallery-arrow-right:hover::before {
                right: 30%; /* Closer connection for narrower button */
            }
        }



        /* Gallery drag/slide functionality */
        .gallery-container {
            cursor: grab;
            user-select: none;
        }

        .gallery-container:active {
            cursor: grabbing;
        }

        .gallery-slides {
            will-change: transform;
        }

        /* Ensure background video fills and stays behind content */
        .gallery-card { position: relative; overflow: hidden; }
        .gallery-bg-video { position: absolute; inset: 0; width: 100%; height: 100%; object-fit: cover; z-index: 0; pointer-events: none; }
        .gallery-card .gallery-container,
        .gallery-card .gallery-slides,
        .gallery-card .gallery-slide { position: relative; z-index: 1; background: transparent !important; }

        /* Mobile responsiveness for home layout */
        @media (max-width: 768px) {
            #intro-column {
                margin-bottom: 60px;
            }

            #intro-description {
                white-space: pre-line;
            }

            #gallery-column {
                justify-content: center;
            }

            .gallery-card {
                height: 58vh;
            }

            .gallery-slide {
                padding: 30px 20px;
            }

            .gallery-slide h3 {
                font-size: 24px;
            }

            .gallery-slide p {
                font-size: 14px;
            }
        }
        /* Contact overrides - scoped to #contact to avoid global collisions */
        #contact .contact-container {
            display: block;
            max-width: 800px;
            margin: 0; /* left-align to section title */
            opacity: 1;
            transform: none;
            margin-bottom: 60px;
        }
        #contact .contact-form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0;
            border-top: 1px solid var(--border-color);
        }
        #contact .form-row { display: contents; }
        #contact .form-group { border-bottom: 1px solid var(--border-color); border-right: 1px solid var(--border-color); position: relative; }
        #contact .form-group:nth-child(even) { border-right: none; }
        #contact .form-group.full-width { grid-column: 1 / -1; border-right: none; }
        #contact .form-field { position: relative; width: 100%; }
        #contact .form-field input, #contact .form-field textarea {
            width: 100%; padding: 24px 20px; border: none; background: transparent; color: var(--text-color);
            font-family: 'Unica77LL', Arial, sans-serif; font-size: 16px; outline: none; resize: none; box-sizing: border-box;
        }
        #contact .form-field textarea { min-height: 120px; }
        #contact .form-field input::placeholder, #contact .form-field textarea::placeholder { color: transparent; }
        #contact .form-label { position: absolute; left: 20px; top: 24px; color: var(--secondary-text-color); font-family: 'Input', monospace; font-size: 12px; text-transform: uppercase; letter-spacing: 0.5px; pointer-events: none; transition: all 0.2s ease; }
        #contact .form-field input:focus + .form-label,
        #contact .form-field input:not(:placeholder-shown) + .form-label,
        #contact .form-field textarea:focus + .form-label,
        #contact .form-field textarea:not(:placeholder-shown) + .form-label,
        #contact .form-label.active { transform: translateY(-8px); font-size: 10px; color: var(--text-color); }
        #contact .form-field input:focus, #contact .form-field textarea:focus { background: rgba(255,255,255,0.5); }
        #contact .submit-group { grid-column: 1 / -1; border-bottom: none; position: relative; overflow: hidden; }
        #contact .submit-button { width: 100%; padding: 32px 20px; border: none; background: rgb(0,5,11); color: var(--bg-color); font-family: 'Input', monospace; font-size: 16px; text-transform: uppercase; letter-spacing: 1px; cursor: pointer; transition: all 0.3s ease; position: relative; overflow: hidden; border-radius: 12px; }
        #contact .submit-button:hover { background: rgb(0,3,8); }
        #contact .submit-button:active { transform: translateY(1px); }
        #contact .form-group:hover { background: rgba(255,255,255,0.3); }
        #contact .form-group:focus-within { background: rgba(255,255,255,0.5); }
        @media (max-width: 768px) {
            #contact .contact-container { max-width: none; }
            #contact .contact-form { grid-template-columns: 1fr; }
            #contact .form-group { border-right: none; }
            #contact .form-field input, #contact .form-field textarea { padding: 20px 16px; }
            #contact .form-label { left: 16px; top: 20px; }
            #contact .submit-button { padding: 24px 16px; }
        }
        #contact .form-success { padding: 40px 20px; text-align: center; border: 1px solid var(--border-color); background: rgba(255,255,255,0.5); border-radius: 12px; margin-top: 16px; }
        #contact .form-success h3 { margin: 0 0 12px 0; font-family: 'Unica77LL', Arial, sans-serif; font-size: 18px; font-weight: 500; }
        #contact .form-success p { margin: 0; color: var(--secondary-text-color); font-size: 14px; }
        #contact .hidden { display: none; }

        /* Design System: Buttons (light mode only) */
        :root {
            --ui-border: #D9D9D9;
            --ui-text: #000810;
            --ui-bg: #ffffff;
            --ui-active-border: #7EBB1C;
            --ui-active-bg: rgba(162,230,51,0.05);
            --ui-alt-active-border: #000810;
            --ui-alt-active-bg: rgba(0,8,16,0.03);
            --ui-error-border: #710C0E;
            --ui-error-bg: rgba(113,12,14,0.05);
            --motion-ms: 1000ms;
            --ease-smooth: cubic-bezier(.2,.7,.2,1);
            --btn-dark: #000810;
            --btn-lime: #A2E633;
            --btn-lime-border: #7EBB1C;
            --btn-gray: #9C9C9C;
            --btn-gray-bg: #F0F0F0;
            --btn-lime-40: rgba(162,230,51,0.40);
            --btn-white: #FFFFFF;
        }

        body:not([data-theme="dark"]) .ui-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            height: 36px;
            padding: 0 20px;
            border-radius: 6px;
            border: 1px solid transparent;
            font-family: 'Unica77LL', Arial, sans-serif;
            font-size: 14px;
            line-height: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: background var(--motion-ms) var(--ease-smooth), border-color var(--motion-ms) var(--ease-smooth), color var(--motion-ms) var(--ease-smooth), box-shadow var(--motion-ms) var(--ease-smooth);
        }
        body:not([data-theme="dark"]) .ui-btn.pill { border-radius: 999px; }
        /* B1 */
        body:not([data-theme="dark"]) .ui-btn[data-variant="b1"] { background: var(--btn-lime-40) !important; border-color: var(--btn-lime-border) !important; color: var(--ui-text) !important; }
        body:not([data-theme="dark"]) .ui-btn[data-variant="b1"]:hover { background: var(--btn-lime) !important; border-color: var(--btn-lime-border) !important; }
        body:not([data-theme="dark"]) .ui-btn[data-variant="b1"][aria-pressed="true"] { background: var(--btn-dark) !important; border-color: var(--btn-dark) !important; color: var(--btn-white) !important; }
        /* B2 */
        body:not([data-theme="dark"]) .ui-btn[data-variant="b2"] { background: var(--btn-lime-40) !important; border-color: var(--btn-lime-border) !important; color: var(--ui-text) !important; }
        body:not([data-theme="dark"]) .ui-btn[data-variant="b2"]:hover { background: var(--btn-lime-40) !important; border-color: var(--btn-lime-border) !important; }
        body:not([data-theme="dark"]) .ui-btn[data-variant="b2"][aria-pressed="true"] { background: var(--btn-lime) !important; border-color: var(--btn-lime-border) !important; color: var(--ui-text) !important; }
        /* B4 */
        body:not([data-theme="dark"]) .ui-btn[data-variant="b4"] {     background: rgba(240, 240, 240, 0.1); border: 1px solid rgba(240, 240, 240, 1);   color: rgba(240, 240, 240, 1); width: auto; height: 48px; }
        body:not([data-theme="dark"]) .ui-btn[data-variant="b4"]:hover { background-color: rgba(240, 240, 240, 0.25); border-color: rgba(240, 240, 240, .6); color: rgba(240, 240, 240, .8); }
        body:not([data-theme="dark"]) .ui-btn[data-variant="b4"][aria-pressed="true"] { background: var(--btn-dark) !important; border-color: var(--btn-dark) !important; color: var(--btn-white) !important; }
        /* B5 */
        body:not([data-theme="dark"]) .ui-btn.pill[data-variant="b5"] { background: var(--btn-white) !important; border-color: var(--btn-gray) !important; color: #777 !important; }
        body:not([data-theme="dark"]) .ui-btn.pill[data-variant="b5"]:hover { background: var(--btn-white) !important; border-color: var(--btn-gray) !important; }
        body:not([data-theme="dark"]) .ui-btn.pill[data-variant="b5"][aria-pressed="true"] { background: var(--btn-dark) !important; border-color: var(--btn-dark) !important; color: var(--btn-white) !important; }
        /* B6 */
        body:not([data-theme="dark"]) .ui-btn.pill[data-variant="b6"] { background: var(--btn-white) !important; border-color: var(--btn-gray) !important; color: #777 !important; }
        body:not([data-theme="dark"]) .ui-btn.pill[data-variant="b6"]:hover { background: var(--btn-dark) !important; border-color: var(--btn-dark) !important; color: var(--btn-white) !important; }
    </style>
</head>
<body>
    <!-- Global Clock Component Container -->
    <div id="global-clock-container"></div>

    <!-- ScrollSmoother Wrapper -->
    <div id="smooth-wrapper">
        <div id="smooth-content">
    
    <!-- Home Section -->
    <section id="home" class="section">
        <div class="section-content">
            <!-- Left Column: Header and Description -->
            <div id="intro-column">
                <div id="intro">
                    <div id="intro-greeting"></div>
                    <div id="intro-description"></div>
                </div>
            </div>
            
            <!-- Right Column: Gallery Card -->
            <div id="gallery-column">
                <div class="gallery-wrapper">
                                    <div class="gallery-card" style="position:relative; overflow:hidden;">
                    <div class="gallery-container">
                        <div class="gallery-slides" id="gallery-slides">
                            <div class="gallery-slide active">
                                <video class="gallery-bg-video" autoplay muted loop playsinline src="https://raw.githubusercontent.com/amachinic/matthewahn.github.io/main/public/assets/eye.mp4"></video>
                                <h3>QA Framework</h3>
                                <p>A systematic approach to UI quality assurance<br>that ensures consistent design standards<br>across teams while maintaining<br>creative flexibility.</p>
                                <button class="gallery-cta ui-btn" data-variant="b4" aria-pressed="false" onclick="navigateToCase('case-study-qa-framework.html')">Explore</button>
                            </div>
                            <div class="gallery-slide">
                                <h3>Design System</h3>
                                <p>Creating cohesive design languages that scale across products and teams, ensuring consistency and efficiency in every interaction.</p>
                                <button class="gallery-cta ui-btn" data-variant="b4" aria-pressed="false">Currently Unavailable</button>
                            </div>
                            <div class="gallery-slide">
                                <h3>Mobile Experience</h3>
                                <p>Crafting intuitive mobile experiences that feel natural and delightful, with careful attention to touch interactions and performance.</p>
                                <button class="gallery-cta ui-btn" data-variant="b4" aria-pressed="false">Currently Unavailable</button>
                            </div>
                            <div class="gallery-slide">
                                <h3>AI Integration</h3>
                                <p>Seamlessly integrating artificial intelligence into user workflows, making complex tasks simple and intelligent automation accessible.</p>
                                <button class="gallery-cta ui-btn" data-variant="b4" aria-pressed="false">Currently Unavailable</button>
                            </div>

                        </div>
                    </div>
                    
                    <!-- Arrow Navigation - Inside gallery card -->
                    <div class="gallery-arrows">
                        <button class="gallery-arrow gallery-arrow-left" id="gallery-prev">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="0.75" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                        <button class="gallery-arrow gallery-arrow-right" id="gallery-next">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M9 18L15 12L9 6" stroke="currentColor" stroke-width="0.75" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                    </div>
                </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Work Section -->
    <section id="work" class="section">
        <div class="section-content">
            <h2 id="work-title" class="section-title">Work</h2>
            <div class="card-grid two-columns">
                <div class="card tall-card">
                    <h3>QA Framework</h3>
                    <p>A systematic approach to UI quality assurance that ensures consistent design standards across teams while maintaining creative flexibility.</p>
                    <button class="work-cta ui-btn" data-variant="b4" aria-pressed="false" onclick="navigateToCase('case-study-qa-framework.html')">Explore</button>
                </div>
                <div class="card tall-card">
                    <h3>Design System</h3>
                    <p>Creating cohesive design languages that scale across products and teams, ensuring consistency and efficiency in every interaction.</p>
                    <button class="work-cta ui-btn" data-variant="b4" aria-pressed="false">Currently Unavailable</button>
                </div>
                <div class="card tall-card">
                    <h3>Mobile Experience</h3>
                    <p>Crafting intuitive mobile experiences that feel natural and delightful, with careful attention to touch interactions and performance.</p>
                    <button class="work-cta ui-btn" data-variant="b4" aria-pressed="false">Currently Unavailable</button>
                </div>
                <div class="card tall-card">
                    <h3>AI Integration</h3>
                    <p>Seamlessly integrating artificial intelligence into user workflows, making complex tasks simple and intelligent automation accessible.</p>
                    <button class="work-cta ui-btn" data-variant="b4" aria-pressed="false">Currently Unavailable</button>
                </div>
            </div>
        </div>
    </section>


    <!-- Contact Section -->
    <section id="contact" class="section">
        <div class="section-content">
            <h2 id="contact-title" class="section-title">Contact</h2>
            <div class="contact-container">
                <form id="contact-form" class="contact-form">
                    <div class="form-group">
                        <div class="form-field">
                            <input type="text" id="name" name="name" placeholder="Your name" required>
                            <label for="name" class="form-label">Name</label>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <div class="form-field">
                            <input type="email" id="email" name="email" placeholder="your@email.com" required>
                            <label for="email" class="form-label">Email</label>
                        </div>
                    </div>
                    
                    <div class="form-group full-width">
                        <div class="form-field">
                            <textarea id="message" name="message" placeholder="Tell me about your project..." required></textarea>
                            <label for="message" class="form-label">Message</label>
                        </div>
                    </div>
                    
                    <div class="form-group submit-group">
                        <button type="submit" class="submit-button ui-btn" data-variant="b1" aria-pressed="false">
                            Send Message
                        </button>
                    </div>
                </form>

                <!-- Success message (hidden by default) -->
                <div id="success-message" class="form-success hidden">
                    <h3>Message sent successfully!</h3>
                    <p>Thank you for reaching out. I'll get back to you soon.</p>
                </div>
            </div>
        </div>
    </section>

        </div>
    </div>

    <!-- New navigation bar -->
    <div id="nav-container">
        <nav id="nav-bar">
            <div class="blur-bg"></div>
            <div id="nav-slider"></div>
            <a href="#home" class="nav-button">Home</a>
            <a href="#work" class="nav-button">Work</a>
            <a href="#contact" class="nav-button">Contact</a>
        </nav>
    </div>

    <script>
        const introGreeting = document.getElementById('intro-greeting');
        const introDescription = document.getElementById('intro-description');
        const greetingText = `Hey! I'm Matthew.`;
        // Different text versions for desktop and mobile
        const descriptionTextDesktop = `I'm a design strategist and engineer. 
I have a deep curiousity in harmonizing humanity and technology.`;

        const descriptionTextMobile = `I'm a design strategist and engineer. 
I have a deep curiousity in harmonizing 
humanity and technology.`;
        
        // Determine which text to use based on screen size
        const isMobile = window.innerWidth <= 768;
        const descriptionText = isMobile ? descriptionTextMobile : descriptionTextDesktop;

        let greetingIndex = 0;
        let descriptionIndex = 0;
        let isGreetingComplete = false;
        let isDescriptionComplete = false;
        let isTypingComplete = false;
        let galleryTriggered = false;
        const multilingualChars = 'αβγδεζηθικλμνξοπρστυφχψωАБВГДЕЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ'
            + '你好世界我爱你中国日本韓國'
            + 'こんにちは世界愛してる日本'
            + '안녕하세요세계사랑해요한국'
            + 'ก็ขคงจฉชซฌญฎฏฐฑฒณดตถทธน'
            + 'ਕਖਗਘਙਚਛਜਝਞਟਠਡਢਣਤਥਦਧਨ਩ਪਫਬਭਮ'
            + 'অআইঈউঊঋঌএঐওঔকখগঘঙচছজঝঞ'
            + 'ابتثجحخدذرزسشصضطظعغفقكلمن'
            + 'אבגדהוזחטছלמנסעפףצץקרשת';

        function getRandomChar() {
            return multilingualChars[Math.floor(Math.random() * multilingualChars.length)];
        }

        function typeGreeting() {
            const spans = introGreeting.querySelectorAll('span');
            
            if (greetingIndex < spans.length) {
                // Show current character
                spans[greetingIndex].style.opacity = '1';
                
                // Add blinking effect for next few characters
                const maxBlinkLength = 3;
                const blinkLength = Math.min(maxBlinkLength, spans.length - greetingIndex - 1);
                
                for (let i = 1; i <= blinkLength; i++) {
                    if (spans[greetingIndex + i]) {
                        spans[greetingIndex + i].textContent = getRandomChar();
                        spans[greetingIndex + i].style.opacity = `${1 - i * 0.25}`;
                        spans[greetingIndex + i].style.color = 'var(--secondary-text-color)';
                    }
                }

                setTimeout(() => {
                    // Reset blinking characters back to original
                    for (let i = 1; i <= blinkLength; i++) {
                        if (spans[greetingIndex + i]) {
                            const originalChar = greetingText[greetingIndex + i];
                            spans[greetingIndex + i].innerHTML = originalChar === ' ' ? '&nbsp;' : originalChar;
                            spans[greetingIndex + i].style.color = '';
                            spans[greetingIndex + i].style.opacity = '0';
                        }
                    }
                    
                    greetingIndex++;
                    typeGreeting();
                }, 50);
            } else {
                isGreetingComplete = true;
                wrapGreetingLetters();
                // Start typing description after a short delay
                setTimeout(() => {
                    typeDescription();
                }, 1000);
            }
        }

        function typeDescription() {
            const spans = introDescription.querySelectorAll('span');
            const currentDescriptionText = window.descriptionText || descriptionText;
            // Create array of non-line-break characters for mapping
            const textChars = currentDescriptionText.split('').filter(char => char !== '\n');
            
            if (descriptionIndex < spans.length) {
                // Show current character
                spans[descriptionIndex].style.opacity = '1';
                
                // Add blinking effect for next few characters
                const maxBlinkLength = 3;
                const blinkLength = Math.min(maxBlinkLength, spans.length - descriptionIndex - 1);
                
                for (let i = 1; i <= blinkLength; i++) {
                    if (spans[descriptionIndex + i]) {
                        spans[descriptionIndex + i].textContent = getRandomChar();
                        spans[descriptionIndex + i].style.opacity = `${1 - i * 0.25}`;
                        spans[descriptionIndex + i].style.color = 'var(--secondary-text-color)';
                    }
                }

                setTimeout(() => {
                    // Reset blinking characters back to original
                    for (let i = 1; i <= blinkLength; i++) {
                        if (spans[descriptionIndex + i] && textChars[descriptionIndex + i]) {
                            const originalChar = textChars[descriptionIndex + i];
                            spans[descriptionIndex + i].innerHTML = originalChar === ' ' ? '&nbsp;' : originalChar;
                            spans[descriptionIndex + i].style.color = '';
                            spans[descriptionIndex + i].style.opacity = '0';
                        }
                    }
                    
                    descriptionIndex++;
                    
                    // Trigger gallery fade-in right after the first sentence finishes
                    const firstPeriodIndex = currentDescriptionText.indexOf('.');
                    if (firstPeriodIndex !== -1 && descriptionIndex >= firstPeriodIndex + 1 && !galleryTriggered) {
                        galleryTriggered = true;
                        triggerGalleryFadeIn();
                    }
                    
                    typeDescription();
                }, 70);
            } else {
                isDescriptionComplete = true;
                isTypingComplete = true;
                wrapDescriptionLetters();
            }
        }

        function wrapGreetingLetters() {
            const spans = introGreeting.querySelectorAll('span');
            spans.forEach((span, index) => {
                const char = greetingText[index];
                span.setAttribute('data-char', char);
                span.style.opacity = '1';
            });
        }

        function wrapDescriptionLetters() {
            const spans = introDescription.querySelectorAll('span');
            const currentDescriptionText = window.descriptionText || descriptionText;
            const textChars = currentDescriptionText.split('').filter(char => char !== '\n');
            
            spans.forEach((span, index) => {
                const char = textChars[index];
                if (char) {
                    span.setAttribute('data-char', char);
                    span.style.opacity = '1';
                }
            });
        }



        typeGreeting();

        function scrambleNearby(e) {
            const greetingSpans = introGreeting.querySelectorAll('span');
            const descriptionSpans = introDescription.querySelectorAll('span');

            const rect = e.currentTarget.getBoundingClientRect();
            const mouseX = e.clientX - rect.left;
            const mouseY = e.clientY - rect.top;

            // Handle greeting spans if greeting is complete
            if (isGreetingComplete) {
                greetingSpans.forEach(span => {
                const spanRect = span.getBoundingClientRect();
                const spanX = spanRect.left - rect.left + spanRect.width / 2;
                const spanY = spanRect.top - rect.top + spanRect.height / 2;
                const distance = Math.sqrt(Math.pow(mouseX - spanX, 2) + Math.pow(mouseY - spanY, 2));

                    if (distance < 15 && span.dataset.char !== '.') {
                    span.textContent = getRandomChar();
                    span.classList.add('scrambled');
                } else {
                    const originalChar = span.dataset.char;
                    span.innerHTML = originalChar === ' ' ? '&nbsp;' : originalChar;
                    span.classList.remove('scrambled');
                }
            });
            }

            // Handle description spans if description is complete
            if (isDescriptionComplete) {
                descriptionSpans.forEach(span => {
                    const spanRect = span.getBoundingClientRect();
                    const spanX = spanRect.left - rect.left + spanRect.width / 2;
                    const spanY = spanRect.top - rect.top + spanRect.height / 2;
                    const distance = Math.sqrt(Math.pow(mouseX - spanX, 2) + Math.pow(mouseY - spanY, 2));

                    if (distance < 15 && span.dataset.char !== '.') {
                        span.textContent = getRandomChar();
                        span.classList.add('scrambled');
                    } else {
                        const originalChar = span.dataset.char;
                        span.innerHTML = originalChar === ' ' ? '&nbsp;' : originalChar;
                        span.classList.remove('scrambled');
                    }
                });
            }
        }

        function revertText() {
            if (isGreetingComplete) {
                const greetingSpans = introGreeting.querySelectorAll('span');
                greetingSpans.forEach(span => {
                    const originalChar = span.dataset.char;
                    span.innerHTML = originalChar === ' ' ? '&nbsp;' : originalChar;
                    span.classList.remove('scrambled');
                });
            }

            if (isDescriptionComplete) {
                const descriptionSpans = introDescription.querySelectorAll('span');
                descriptionSpans.forEach(span => {
                    const originalChar = span.dataset.char;
                    span.innerHTML = originalChar === ' ' ? '&nbsp;' : originalChar;
                    span.classList.remove('scrambled');
                });
            }
        }

        document.getElementById('intro').addEventListener('mousemove', scrambleNearby);
        document.getElementById('intro').addEventListener('mouseleave', revertText);

        // Store original characters after typing is complete
        document.getElementById('intro').addEventListener('DOMSubtreeModified', () => {
            if (isTypingComplete) {
                const greetingSpans = introGreeting.querySelectorAll('span');
                const descriptionSpans = introDescription.querySelectorAll('span');
                const allSpans = [...greetingSpans, ...descriptionSpans];
                
                allSpans.forEach(span => {
                    if (!span.dataset.originalChar) {
                        span.dataset.originalChar = span.textContent;
                    }
                });
            }
        }, { once: true });



        // Elegant case study navigation with smooth transition
        function navigateToCase(url) {
            if (document.body.classList.contains('navigating')) return;
            document.body.classList.add('navigating');
            document.body.classList.add('fade-out');
            setTimeout(() => { window.location.href = url; }, 800);
        }



        // Scroll handler for navigation
        function handleScroll() {
            const navContainer = document.getElementById('nav-container');

            // Keep glass-like appearance for bottom nav
            navContainer.style.backgroundColor = 'transparent';
        }

        // Navigation slider positioning
        function updateNavSlider(activeButton) {
            const slider = document.getElementById('nav-slider');
            const navBar = document.getElementById('nav-bar');
            
            if (activeButton) {
                // Use offsetLeft for accurate positioning relative to the nav-bar
                const left = activeButton.offsetLeft;
                const width = activeButton.offsetWidth;
                
                slider.style.left = `${left}px`;
                slider.style.width = `${width}px`;
                slider.style.opacity = '1';
            } else {
                slider.style.opacity = '0';
            }
        }

        let isManualNavigation = false;

        // Navigation active state tracking
        function updateActiveNavigation() {
            // Don't update navigation during manual navigation
            if (isManualNavigation) return;

            const sections = document.querySelectorAll('.section');
            const navButtons = document.querySelectorAll('.nav-button');
            const headerOffset = 120; // Fixed header height
            const currentScrollY = window.scrollY;
            const windowHeight = window.innerHeight;
            const documentHeight = document.documentElement.scrollHeight;

            let currentSection = 'home'; // Default to home
            let activeButton = null;

            // Check if we're near the bottom of the page for better contact section detection
            const isNearBottom = (currentScrollY + windowHeight) >= (documentHeight - 50);

            sections.forEach((section, index) => {
                const sectionTop = section.offsetTop - headerOffset; // Account for header offset
                const sectionBottom = sectionTop + section.offsetHeight;
                const sectionId = section.getAttribute('id');
                const isLastSection = index === sections.length - 1;

                // For the last section (contact), activate when near bottom or when in normal range
                if (isLastSection && isNearBottom) {
                    currentSection = sectionId;
                } else if (currentScrollY >= sectionTop && currentScrollY < sectionBottom) {
                    currentSection = sectionId;
                }
            });

            // Update navigation buttons and find active button
            navButtons.forEach(button => {
                const href = button.getAttribute('href');
                if (href === `#${currentSection}`) {
                    button.classList.add('active');
                    activeButton = button;
                } else {
                    button.classList.remove('active');
                }
            });

            // Update slider position
            updateNavSlider(activeButton);
        }

        // Initialize GSAP plugins for Home page
        gsap.registerPlugin(ScrollSmoother, ScrollTrigger, ScrollToPlugin);

        // Initialize smooth scrolling consistent with case study page
        (function initScrollSmoother() {
            if (typeof ScrollSmoother === 'undefined') return;
            try {
                const smoother = ScrollSmoother.create({
                    wrapper: "#smooth-wrapper",
                    content: "#smooth-content",
                    smooth: 1,
                    effects: false,
                    smoothTouch: 0.1,
                    normalizeScroll: false,
                    ignoreMobileResize: true
                });
                window.smoother = smoother;
            } catch (e) {
                console.warn('ScrollSmoother init failed:', e);
            }
        })();

        // Advanced GSAP smooth scrolling for navigation
        function smoothScrollToSection(targetId) {
            const targetSection = document.querySelector(targetId);
            if (targetSection) {
                const headerOffset = 120; // Offset for clock container
                
                if (window.smoother) {
                    window.smoother.scrollTo(targetSection, {
                        duration: 1.4,
                        offsetY: headerOffset,
                        ease: "power3.inOut",
                        onStart: () => { document.body.style.pointerEvents = 'none'; },
                        onComplete: () => {
                            document.body.style.pointerEvents = 'auto';
                            setTimeout(() => { if (!isManualNavigation) updateActiveNavigation(); }, 50);
                        }
                    });
                } else {
                    // Kill any existing scroll animations for smooth interruption
                    gsap.killTweensOf(window);
                    gsap.to(window, {
                        duration: 1.4,
                        scrollTo: { y: targetSection, offsetY: headerOffset, autoKill: false },
                        ease: "power3.inOut",
                        onStart: () => { document.body.style.pointerEvents = 'none'; },
                        onComplete: () => {
                            document.body.style.pointerEvents = 'auto';
                            setTimeout(() => { if (!isManualNavigation) updateActiveNavigation(); }, 50);
                        }
                    });
                }
            }
        }

        // Enhanced scroll to top with elegant animation
        function smoothScrollToTop() {
            if (window.smoother) {
                window.smoother.scrollTo(0, { duration: 1.8, ease: "power4.inOut" });
            } else {
                gsap.killTweensOf(window);
                gsap.to(window, {
                    duration: 1.8,
                    scrollTo: { y: 0 },
                    ease: "power4.inOut",
                    onStart: () => { document.body.style.pointerEvents = 'none'; },
                    onComplete: () => { document.body.style.pointerEvents = 'auto'; }
                });
            }
        }

        // Function to trigger gallery fade-in
        function triggerGalleryFadeIn() {
            const galleryCard = document.querySelector('.gallery-card');
            if (!galleryCard) return;
            gsap.to(galleryCard, {
                opacity: 1,
                y: 0,
                scale: 1,
                duration: 0.6,
                ease: "power2.out"
            });
        }

        // Function to restart typing animation
        function restartTypingAnimation() {
            // Reset all typing variables
            greetingIndex = 0;
            descriptionIndex = 0;
            isGreetingComplete = false;
            isDescriptionComplete = false;
            isTypingComplete = false;
            galleryTriggered = false;
            
            // Update description text based on current screen size
            const isMobile = window.innerWidth <= 768;
            const newDescriptionText = isMobile ? descriptionTextMobile : descriptionTextDesktop;
            
            // Update the global descriptionText variable
            window.descriptionText = newDescriptionText;
            
            // Reset gallery card
            const galleryCard = document.querySelector('.gallery-card');
            
            if (galleryCard) {
                gsap.set(galleryCard, {
                    opacity: 0,
                    y: 10,
                    scale: 1
                });
            }
            
            // Update description content if screen size changed
            const currentIsMobile = window.innerWidth <= 768;
            const currentDescriptionText = currentIsMobile ? 
                `I'm a design strategist and engineer. 
I have a deep curiousity in harmonizing 
humanity and technology.` :
                `I'm a design strategist and engineer. 
I have a deep curiousity in harmonizing humanity and technology.`;

            // Rebuild description spans if text content changed
            if (newDescriptionText !== currentDescriptionText) {
                introDescription.innerHTML = newDescriptionText.split('').map(char => {
                    if (char === '\n') {
                        return '<br>';
                    } else {
                        return char === ' ' ? `<span style="opacity: 0;">&nbsp;</span>` : `<span style="opacity: 0;">${char}</span>`;
                    }
                }).join('');
            }
            
            // Reset existing spans
            const greetingSpans = introGreeting.querySelectorAll('span');
            const descriptionSpans = introDescription.querySelectorAll('span');
            
            greetingSpans.forEach(span => span.style.opacity = '0');
            descriptionSpans.forEach(span => span.style.opacity = '0');
            
            // Start typing sequence
            typeGreeting();
        }

        // Add click handlers to navigation buttons
        document.querySelectorAll('.nav-button').forEach(button => {
            button.addEventListener('click', function(e) {
                e.preventDefault();
                const targetId = this.getAttribute('href');
                
                // Prevent scroll-based navigation updates during manual navigation
                isManualNavigation = true;
                
                // Immediately update slider to clicked button
                document.querySelectorAll('.nav-button').forEach(btn => btn.classList.remove('active'));
                this.classList.add('active');
                updateNavSlider(this);
                
                // Scroll to target section
                smoothScrollToSection(targetId);
                
                // Extended timeout to prevent bouncing - wait for animation to complete fully
                setTimeout(() => {
                    isManualNavigation = false;
                }, 1600); // Match GSAP animation duration (1.4s) + buffer
            });
        });

        // Add event listener for scroll
        // Initialize Global Clock Component
        const globalClock = new GlobalClockComponent({
            showNameDisplay: true,
            hideLocationClock: false,
            backLinkText: '' // No back button on home page
        });
        
        // Inject the component's CSS
        const style = document.createElement('style');
        style.textContent = globalClock.getCSS();
        document.head.appendChild(style);
        
        // Render the component
        const clockContainer = document.getElementById('global-clock-container');
        if (clockContainer) {
            clockContainer.innerHTML = globalClock.getHTML();
            globalClock.init();
        }

        window.addEventListener('scroll', handleScroll);
        window.addEventListener('scroll', updateActiveNavigation);
        
        // Add resize event listener for responsive navigation slider
        window.addEventListener('resize', function() {
            // Recalculate slider position on window resize
            const activeButton = document.querySelector('.nav-button.active');
            if (activeButton) {
                updateNavSlider(activeButton);
            }
        });
        
        // Call once to set initial state
        handleScroll();
        updateActiveNavigation();

        // Gallery slider functionality
        let currentSlide = 0;
        const totalSlides = 4;
        const slidesContainer = document.getElementById('gallery-slides');
        const galleryContainer = document.querySelector('.gallery-container');
        const prevButton = document.getElementById('gallery-prev');
        const nextButton = document.getElementById('gallery-next');
        
        function updateGallerySlide(slideIndex) {
            currentSlide = slideIndex;
            const slides = document.querySelectorAll('.gallery-slide');
            
            // Simple slide switching - just update active class
            slides.forEach((slide, index) => {
                slide.classList.remove('active');
                if (index === slideIndex) {
                    slide.classList.add('active');
                }
            });
            
            // Update arrow visibility based on current position
            updateArrowVisibility();
        }
        
        function updateArrowVisibility() {
            const leftArrow = document.getElementById('gallery-prev');
            const rightArrow = document.getElementById('gallery-next');
            
            if (leftArrow && rightArrow) {
                // Always show both arrows for bi-directional navigation
                leftArrow.style.display = 'flex';
                rightArrow.style.display = 'flex';
            }
        }

        function nextSlide() {
            const nextIndex = (currentSlide + 1) % totalSlides;
            updateGallerySlide(nextIndex);
        }

        function prevSlide() {
            const prevIndex = (currentSlide - 1 + totalSlides) % totalSlides;
            updateGallerySlide(prevIndex);
        }

        // Drag/slide variables
        let isDragging = false;
        let startX = 0;
        let startY = 0;



        // Mouse drag functionality
        galleryContainer.addEventListener('mousedown', handleStart);
        galleryContainer.addEventListener('mousemove', handleMove);
        galleryContainer.addEventListener('mouseup', handleEnd);
        galleryContainer.addEventListener('mouseleave', handleEnd);

        // Touch functionality for mobile
        galleryContainer.addEventListener('touchstart', handleStart);
        galleryContainer.addEventListener('touchmove', handleMove);
        galleryContainer.addEventListener('touchend', handleEnd);

        function handleStart(e) {
            isDragging = true;
            startX = e.type === 'mousedown' ? e.clientX : e.touches[0].clientX;
            startY = e.type === 'mousedown' ? e.clientY : e.touches[0].clientY;
        }

        function handleMove(e) {
            if (!isDragging) return;
            
            e.preventDefault();
            // Visual feedback during drag can be added here if needed
        }

        function handleEnd(e) {
            if (!isDragging) return;
            
            isDragging = false;
            
            // Calculate drag distance and direction
            const currentX = e.type === 'mouseup' ? e.clientX : (e.changedTouches ? e.changedTouches[0].clientX : startX);
            const currentY = e.type === 'mouseup' ? e.clientY : (e.changedTouches ? e.changedTouches[0].clientY : startY);
            
            const deltaX = currentX - startX;
            const deltaY = currentY - startY;
            const containerWidth = galleryContainer.offsetWidth;
            
            // Determine if it's a horizontal swipe (more horizontal than vertical)
            const minSwipeDistance = containerWidth * 0.1; // Reduced threshold for easier swiping
            
            if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > minSwipeDistance) {
                if (deltaX > 0) {
                    // Swiped right - go to previous card
                    prevSlide();
                } else {
                    // Swiped left - go to next card
                    nextSlide();
                }
            }
        }

        // Arrow navigation event listeners
        if (prevButton && nextButton) {
            prevButton.addEventListener('click', (e) => {
                e.preventDefault();
                e.stopPropagation();
                prevSlide();
            });

            nextButton.addEventListener('click', (e) => {
                e.preventDefault();
                e.stopPropagation();
                nextSlide();
            });
        }

        // Initialize gallery on page load
        updateGallerySlide(0);
        
        // Set initial arrow visibility
        updateArrowVisibility();

        // Set initial state for all animated elements immediately to prevent layout shifts
        const initialCards = document.querySelectorAll('.card');
        const initialTitles = document.querySelectorAll('.section-title');
        const galleryCard = document.querySelector('.gallery-card');
        
        // Force all cards to initial state immediately, regardless of class
        initialCards.forEach(card => {
            gsap.set(card, {
                opacity: 0,
                y: 30,
                force3D: true // Use hardware acceleration
            });
        });
        
        // Set up section titles immediately with proper spacing
        initialTitles.forEach(title => {
            const titleText = title.textContent.trim();
            // Set full text immediately with invisible characters to reserve space
            title.innerHTML = titleText.split('').map(char => 
                char === ' ' ? ' ' : `<span style="opacity: 0;">${char}</span>`
            ).join('');
            gsap.set(title, { opacity: 0 });
        });
        
        if (galleryCard) {
            gsap.set(galleryCard, { opacity: 0, y: 10 });
        }
        
        // Set up contact container initial state
        const contactContainer = document.querySelector('.contact-container');
        if (contactContainer) {
            gsap.set(contactContainer, {
                opacity: 0,
                y: 30,
                force3D: true
            });
        }
        
        // Set up intro text immediately to prevent home section height changes
        // Use the same variables that the typing animation expects
        if (introGreeting && introDescription) {
            // Set full greeting text immediately with invisible characters (every character gets a span)
            introGreeting.innerHTML = greetingText.split('').map(char => 
                char === ' ' ? `<span data-char="${char}" style="opacity: 0;">&nbsp;</span>` : `<span data-char="${char}" style="opacity: 0;">${char}</span>`
            ).join('');
            
            // Set full description text immediately with invisible characters (every character except line breaks gets a span)
            const currentDescriptionText = isMobile ? descriptionTextMobile : descriptionTextDesktop;
            introDescription.innerHTML = currentDescriptionText.split('').map(char => {
                if (char === '\n') {
                    return '<br>';
                } else {
                    return char === ' ' ? `<span data-char="${char}" style="opacity: 0;">&nbsp;</span>` : `<span data-char="${char}" style="opacity: 0;">${char}</span>`;
                }
            }).join('');
        }
        
        // Force all sections to maintain stable layout during animations
        const allSections = document.querySelectorAll('.section');
        allSections.forEach(section => {
            const sectionContent = section.querySelector('.section-content');
            if (sectionContent) {
                gsap.set(sectionContent, {
                    force3D: true // Hardware acceleration for stability
                });
            }
        });
        

        
        // Section title typing animation
        const sectionTitles = [
            { id: 'work-title', text: 'Work' },
            { id: 'contact-title', text: 'Contact' }
        ];

        const animatedSections = new Set();

        function typeSectionTitle(titleConfig) {
            const element = document.getElementById(titleConfig.id);
            if (!element || animatedSections.has(titleConfig.id)) return;

            animatedSections.add(titleConfig.id);
            element.classList.add('typing');
            
            // GSAP fade-in animation for container
            gsap.to(element, {
                opacity: 1,
                duration: 0.8,
                ease: "power2.out",
                delay: 0.2
            });
            
            // Delay the start of typing by 0.2 seconds (synchronized with GSAP)
            setTimeout(() => {
                let index = 0;
                const spans = element.querySelectorAll('span');

                function typeCharacter() {
                    if (index < spans.length) {
                        // Show current character
                        spans[index].style.opacity = '1';
                        
                        // Add blinking effect for next few characters
                        const maxBlinkLength = 2;
                        const blinkLength = Math.min(maxBlinkLength, spans.length - index - 1);
                        
                        for (let i = 1; i <= blinkLength; i++) {
                            if (spans[index + i]) {
                                spans[index + i].textContent = getRandomChar();
                                spans[index + i].style.opacity = `${1 - i * 0.3}`;
                                spans[index + i].style.color = 'var(--secondary-text-color)';
                            }
                        }

                        setTimeout(() => {
                            // Reset blinking characters back to original
                            for (let i = 1; i <= blinkLength; i++) {
                                if (spans[index + i]) {
                                    spans[index + i].textContent = titleConfig.text[index + i];
                                    spans[index + i].style.color = '';
                                    spans[index + i].style.opacity = '0';
                                }
                            }
                            
                            index++;
                            setTimeout(typeCharacter, 40);
                        }, 50);
                    } else {
                        // Animation complete - all characters visible
                        spans.forEach(span => {
                            span.style.opacity = '1';
                            span.style.color = '';
                        });
                    }
                }

                typeCharacter();
            }, 200);
        }

        function wrapSectionTitleLetters(element, text) {
            element.innerHTML = text.split('').map((char, index) => 
                char === ' ' ? ' ' : `<span data-original="${char}" data-index="${index}">${char}</span>`
            ).join('');

            const spans = element.querySelectorAll('span');
            
            // Just wrap letters in spans for styling, no hover events
            spans.forEach((span, index) => {
                span.style.userSelect = 'none'; // Prevent text selection
            });
        }

        function checkSectionVisibility() {
            sectionTitles.forEach(titleConfig => {
                const section = document.getElementById(titleConfig.id.replace('-title', ''));
                if (section && !animatedSections.has(titleConfig.id)) {
                    const rect = section.getBoundingClientRect();
                    const windowHeight = window.innerHeight;
                    
                    // Trigger when section is 70% visible
                    if (rect.top < windowHeight * 0.7 && rect.bottom > 0) {
                        typeSectionTitle(titleConfig);
                        animateCardsInSection(section);
                    }
                }
            });
        }

        // Track animated cards to prevent re-animation
        const animatedCards = new Set();

        function animateCardsInSection(section) {
            const cards = section.querySelectorAll('.card');
            const searchContainer = section.querySelector('.search-container');
            const contactContainer = section.querySelector('.contact-container');
            const sectionId = section.id;
            
            if (!animatedCards.has(sectionId)) {
                animatedCards.add(sectionId);
                
                if (sectionId === 'contact' && contactContainer) {
                    // Contact section: animate contact container
                    gsap.to(contactContainer, {
                        opacity: 1,
                        y: 0,
                        duration: 0.6,
                        ease: "power2.out",
                        delay: 0.3
                    });
                } else {
                    // Other sections: individual card animation
                    cards.forEach((card, index) => {
                        gsap.to(card, {
                            opacity: 1,
                            y: 0,
                            duration: 0.25,
                            ease: "power2.in",
                            delay: 0.2 + (index * 0.06)
                        });
                    });
                }
            }
        }

        // Initialize scroll listener for section animations
        window.addEventListener('scroll', checkSectionVisibility);
        window.addEventListener('load', checkSectionVisibility);

        // Handle window resize to update description text if needed
        window.addEventListener('resize', function() {
            // Debounce resize events
            clearTimeout(window.resizeTimeout);
            window.resizeTimeout = setTimeout(() => {
                const currentIsMobile = window.innerWidth <= 768;
                const currentDescriptionText = currentIsMobile ? descriptionTextMobile : descriptionTextDesktop;
                
                // Only rebuild if the text should actually change
                if (currentIsMobile !== isMobile) {
                    // Update global variable
                    window.isMobile = currentIsMobile;
                    window.descriptionText = currentDescriptionText;
                    
                    // Rebuild description spans with correct text
                    if (introDescription) {
                        introDescription.innerHTML = currentDescriptionText.split('').map(char => {
                            if (char === '\n') {
                                return '<br>';
                            } else {
                                return char === ' ' ? `<span data-char="${char}" style="opacity: 0;">&nbsp;</span>` : `<span data-char="${char}" style="opacity: 0;">${char}</span>`;
                            }
                        }).join('');
                        
                        // If typing is complete, make all spans visible
                        if (isDescriptionComplete) {
                            const spans = introDescription.querySelectorAll('span');
                            spans.forEach(span => span.style.opacity = '1');
                        }
                    }
                }
            }, 250);
        });

        // Set initial state for all cards immediately to prevent layout shifts
        const allCards = document.querySelectorAll('.card');
        gsap.set(allCards, {
            opacity: 0,
            y: 30
        });

        // Auto-advance removed - gallery is now fully manual
        
        // Reset animation state and start greeting
        greetingIndex = 0;
        descriptionIndex = 0;
        isGreetingComplete = false;
        isDescriptionComplete = false;
        isTypingComplete = false;
        galleryTriggered = false;
        
        // Ensure description stays hidden until greeting is complete
        if (introDescription) {
            const descSpans = introDescription.querySelectorAll('span');
            descSpans.forEach(span => span.style.opacity = '0');
        }
        
        // Start typing animation with greeting only
        typeGreeting();




        // Gallery CTA buttons are display-only with hover states

        // Archive search removed

        // Archive functionality removed

        // Contact form and canvas functionality
        const mobileCanvas = document.getElementById('drawing-canvas');
        const desktopCanvas = document.getElementById('drawing-canvas-desktop');
        const mobileCtx = mobileCanvas ? mobileCanvas.getContext('2d') : null;
        const desktopCtx = desktopCanvas ? desktopCanvas.getContext('2d') : null;
        const clearBtns = document.querySelectorAll('.clear-btn');
        const brushSizeSliders = document.querySelectorAll('.brush-slider');
        const contactForm = document.getElementById('contact-form');

        // Canvas drawing functionality
        function setupCanvas(canvas, ctx, clearBtn, brushSizeSlider) {
            if (!canvas || !ctx) return;

            let isDrawing = false;
            let brushSize = 3;

            // Set up canvas
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
            ctx.strokeStyle = '#333';
            ctx.lineWidth = brushSize;

            // Brush size control
            if (brushSizeSlider) {
                brushSizeSlider.addEventListener('input', function() {
                    brushSize = this.value;
                    ctx.lineWidth = brushSize;
                });
            }

            // Mouse events
            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('mouseout', stopDrawing);

            // Touch events for mobile
            canvas.addEventListener('touchstart', handleTouch);
            canvas.addEventListener('touchmove', handleTouch);
            canvas.addEventListener('touchend', stopDrawing);

            function startDrawing(e) {
                isDrawing = true;
                const rect = canvas.getBoundingClientRect();
                const scaleX = canvas.width / rect.width;
                const scaleY = canvas.height / rect.height;
                const x = (e.clientX - rect.left) * scaleX;
                const y = (e.clientY - rect.top) * scaleY;
                ctx.beginPath();
                ctx.moveTo(x, y);
            }

            function draw(e) {
                if (!isDrawing) return;
                const rect = canvas.getBoundingClientRect();
                const scaleX = canvas.width / rect.width;
                const scaleY = canvas.height / rect.height;
                const x = (e.clientX - rect.left) * scaleX;
                const y = (e.clientY - rect.top) * scaleY;
                ctx.lineTo(x, y);
                ctx.stroke();
            }

            function stopDrawing() {
                isDrawing = false;
                ctx.beginPath();
            }

            function handleTouch(e) {
                e.preventDefault();
                const touch = e.touches[0];
                const mouseEvent = new MouseEvent(e.type === 'touchstart' ? 'mousedown' : 
                                                  e.type === 'touchmove' ? 'mousemove' : 'mouseup', {
                    clientX: touch.clientX,
                    clientY: touch.clientY
                });
                canvas.dispatchEvent(mouseEvent);
            }

            // Clear canvas
            if (clearBtn) {
                clearBtn.addEventListener('click', function() {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                });
            }
        }

        // Set up both canvases
        const mobileBrushSlider = document.getElementById('brush-size');
        const desktopBrushSlider = document.getElementById('brush-size-desktop');
        const mobileClearBtn = document.querySelector('.canvas-form-group .clear-btn');
        const desktopClearBtn = document.querySelector('.desktop-canvas-field .clear-btn');

        setupCanvas(mobileCanvas, mobileCtx, mobileClearBtn, mobileBrushSlider);
        setupCanvas(desktopCanvas, desktopCtx, desktopClearBtn, desktopBrushSlider);

                        // Simple toggle functionality - select the visible toggle based on screen size
        function getActiveToggleElements() {
            // Check which toggle container is actually visible instead of relying on screen width
            const mobileContainer = document.querySelector('.mobile-toggle-container');
            const desktopContainer = document.querySelector('.desktop-toggle-container');
            
            const mobileVisible = mobileContainer && window.getComputedStyle(mobileContainer).display !== 'none';
            const desktopVisible = desktopContainer && window.getComputedStyle(desktopContainer).display !== 'none';
            
            if (mobileVisible) {
                return {
                    thumb: document.querySelector('.mobile-toggle-container .send-toggle-thumb'),
                    track: document.querySelector('.mobile-toggle-container .send-toggle-track'),
                    text: document.querySelector('.mobile-toggle-container .send-toggle-text')
                };
            } else if (desktopVisible) {
                return {
                    thumb: document.querySelector('.desktop-toggle-container .send-toggle-thumb'),
                    track: document.querySelector('.desktop-toggle-container .send-toggle-track'),
                    text: document.querySelector('.desktop-toggle-container .send-toggle-text')
                };
            }
            
            // Fallback: if neither is visible, check screen width
            const isMobileView = window.innerWidth <= 768;
            if (isMobileView) {
                return {
                    thumb: document.querySelector('.mobile-toggle-container .send-toggle-thumb'),
                    track: document.querySelector('.mobile-toggle-container .send-toggle-track'),
                    text: document.querySelector('.mobile-toggle-container .send-toggle-text')
                };
            } else {
                return {
                    thumb: document.querySelector('.desktop-toggle-container .send-toggle-thumb'),
                    track: document.querySelector('.desktop-toggle-container .send-toggle-track'),
                    text: document.querySelector('.desktop-toggle-container .send-toggle-text')
                };
            }
        }

        let activeToggle = null;
        let sendToggleThumb = null;
        let sendToggleTrack = null;
        
        let isToggleDragging = false;
        let dragStartX = 0;
        let thumbStartX = 0;
        let isToggleActive = false; // Track toggle state
        let hasDraggedDistance = false; // Track if we've actually moved during drag

        // Function to bind events to toggle elements
        function bindToggleEvents(thumbElement, trackElement) {
            if (!thumbElement || !trackElement) return;
            
            // Remove existing event listeners to prevent duplicates
            thumbElement.removeEventListener('click', handleToggleClick);
            trackElement.removeEventListener('click', handleTrackClick);
            thumbElement.removeEventListener('mousedown', startDrag);
            thumbElement.removeEventListener('touchstart', startDrag);
            
            // Add event listeners for both mouse and touch
            thumbElement.addEventListener('click', handleToggleClick);
            trackElement.addEventListener('click', handleTrackClick);
            thumbElement.addEventListener('mousedown', startDrag);
            thumbElement.addEventListener('touchstart', startDrag, { passive: false });
            
            // Ensure track can handle touch clicks too
            trackElement.addEventListener('touchstart', function(e) {
                if (e.target === thumbElement) return;
                e.preventDefault();
                handleTrackClick(e);
            }, { passive: false });
        }

        // Initialize toggle with retry logic
        function initializeToggle() {
            activeToggle = getActiveToggleElements();
            sendToggleThumb = activeToggle.thumb;
            sendToggleTrack = activeToggle.track;
            
            if (sendToggleThumb && sendToggleTrack) {
                console.log('Toggle elements found:', { thumb: !!sendToggleThumb, track: !!sendToggleTrack });
                updateTogglePositions();
                bindToggleEvents(sendToggleThumb, sendToggleTrack);
                
                // Global events for drag (attached once per successful init)
                document.addEventListener('mousemove', drag);
                document.addEventListener('mouseup', endDrag);
                document.addEventListener('touchmove', drag, { passive: false });
                document.addEventListener('touchend', endDrag);
                
                // Initialize position
                setTimeout(() => {
                    updateTogglePositions();
                    if (sendToggleThumb) {
                        sendToggleThumb.style.left = window.leftPosition + 'px';
                        console.log('Initialized toggle at position:', window.leftPosition);
                    }
                }, 100);
                
                return true;
            } else {
                console.log('Toggle elements not found, retrying...', { thumb: !!sendToggleThumb, track: !!sendToggleTrack });
                return false;
            }
        }
        
        // Try to initialize immediately, with retry logic
        if (!initializeToggle()) {
            // If initial attempt fails, retry with delays
            setTimeout(() => {
                if (!initializeToggle()) {
                    setTimeout(() => {
                        initializeToggle();
                    }, 500);
                }
            }, 100);
        }

            function updateTogglePositions() {
                const currentTrack = activeToggle.track;
                if (!currentTrack) return;
                
                const trackWidth = currentTrack.offsetWidth;
                const thumbWidth = 76; // Fixed thumb width for consistent calculation
                const availableSpace = trackWidth - thumbWidth; // Space for thumb to move
                const paddingPercent = 0.1; // 10% padding on each side like vertical centering
                
                window.leftPosition = availableSpace * paddingPercent;
                window.rightPosition = trackWidth - thumbWidth - (availableSpace * paddingPercent);
                window.midPoint = (window.leftPosition + window.rightPosition) / 2;
                window.trackWidth = trackWidth;
                window.thumbWidth = thumbWidth;
                
                console.log('Updated positions:', {
                    trackWidth,
                    thumbWidth,
                    leftPosition: window.leftPosition,
                    rightPosition: window.rightPosition,
                    midPoint: window.midPoint
                });
            }

            let clickTimeout = null;

            function handleToggleClick(e) {
                e.stopPropagation();
                // Small delay to distinguish from drag
                clickTimeout = setTimeout(() => {
                    if (!isToggleDragging && !hasDraggedDistance) {
                        console.log('Toggle click triggered');
                        togglePosition();
                    }
                }, 50);
            }

            function handleTrackClick(e) {
                const currentThumb = activeToggle.thumb;
                if (e.target === currentThumb) return; // Don't trigger if clicking on thumb
                e.stopPropagation();
                
                // Small delay to distinguish from drag
                clickTimeout = setTimeout(() => {
                    if (!isToggleDragging && !hasDraggedDistance) {
                        console.log('Track click triggered');
                        togglePosition();
                    }
                }, 50);
            }

            function togglePosition() {
                const currentThumb = activeToggle.thumb;
                if (!currentThumb) return;
                
                isToggleActive = !isToggleActive;
                currentThumb.style.transition = 'all 0.3s ease';
                
                if (isToggleActive) {
                    currentThumb.style.left = window.rightPosition + 'px';
                    currentThumb.classList.add('active');
                    sendMessage();
                } else {
                    currentThumb.style.left = window.leftPosition + 'px';
                    currentThumb.classList.remove('active');
                }
            }

            function startDrag(e) {
                e.preventDefault();
                
                console.log('startDrag called');
                
                const currentThumb = activeToggle.thumb;
                if (!currentThumb) return;
                
                // Clear any pending click timeout
                if (clickTimeout) {
                    clearTimeout(clickTimeout);
                    clickTimeout = null;
                }
                
                isToggleDragging = true;
                hasDraggedDistance = false;
                const clientX = e.type === 'touchstart' ? e.touches[0].clientX : e.clientX;
                dragStartX = clientX;
                thumbStartX = currentThumb.offsetLeft;
                currentThumb.style.transition = 'none';
                currentThumb.style.cursor = 'grabbing';
            }

            function drag(e) {
                if (!isToggleDragging) return;
                e.preventDefault();

                const currentThumb = activeToggle.thumb;
                if (!currentThumb) return;

                const clientX = e.type === 'touchmove' ? e.touches[0].clientX : e.clientX;
                const deltaX = clientX - dragStartX;
                
                // Track if we've moved significantly
                if (Math.abs(deltaX) > 5) {
                    hasDraggedDistance = true;
                }
                
                let newPosition = thumbStartX + deltaX;

                // Constrain within bounds
                newPosition = Math.max(window.leftPosition, Math.min(newPosition, window.rightPosition));
                currentThumb.style.left = newPosition + 'px';
                
                console.log('Dragging to position:', newPosition);
            }

            function endDrag(e) {
                if (!isToggleDragging) return;
                
                console.log('endDrag called, hasDraggedDistance:', hasDraggedDistance);
                isToggleDragging = false;
                
                const currentThumb = activeToggle.thumb;
                if (!currentThumb) return;
                
                currentThumb.style.cursor = 'pointer';
                
                // If we haven't dragged significantly, treat as click
                if (!hasDraggedDistance) {
                    console.log('No drag distance, treating as click');
                    // Let the click handler deal with this
                    return;
                }
                
                const currentPosition = currentThumb.offsetLeft;
                currentThumb.style.transition = 'all 0.3s ease';
                
                // Update positions in case of resize
                updateTogglePositions();
                
                console.log('Current position:', currentPosition);
                console.log('Left position:', window.leftPosition);
                console.log('Right position:', window.rightPosition);
                
                // Snap to nearest edge based on current position
                const distanceToLeft = Math.abs(currentPosition - window.leftPosition);
                const distanceToRight = Math.abs(currentPosition - window.rightPosition);
                
                console.log('Distance to left:', distanceToLeft);
                console.log('Distance to right:', distanceToRight);
                
                if (distanceToLeft <= distanceToRight) {
                    // Snap to left
                    console.log('Snapping to left');
                    currentThumb.style.left = window.leftPosition + 'px';
                    currentThumb.classList.remove('active');
                    isToggleActive = false;
                } else {
                    // Snap to right
                    console.log('Snapping to right');
                    currentThumb.style.left = window.rightPosition + 'px';
                    currentThumb.classList.add('active');
                    isToggleActive = true;
                    sendMessage();
                }
                
                // Reset drag flag after the interaction is complete to allow future track clicks
                setTimeout(() => {
                    hasDraggedDistance = false;
                    console.log('Reset hasDraggedDistance flag - track clicks now enabled');
                }, 100);
            }

            function sendMessage() {
                // Get drawing from the appropriate canvas (mobile or desktop)
                const isMobileView = window.innerWidth <= 768;
                const activeCanvas = isMobileView ? mobileCanvas : desktopCanvas;
                
                const formData = {
                    preferredName: document.getElementById('preferred-name').value,
                    email: document.getElementById('email').value,
                    phone: document.getElementById('phone').value,
                    drawing: activeCanvas ? activeCanvas.toDataURL() : null
                };

                console.log('Message sent:', formData);
                
                // Clear form and canvases
                if (contactForm) {
                    contactForm.reset();
                }
                if (mobileCanvas && mobileCtx) {
                    mobileCtx.clearRect(0, 0, mobileCanvas.width, mobileCanvas.height);
                }
                if (desktopCanvas && desktopCtx) {
                    desktopCtx.clearRect(0, 0, desktopCanvas.width, desktopCanvas.height);
                }
            }

            // Handle window resize
            window.addEventListener('resize', () => {
                // Re-initialize toggle for new screen size
                const wasActive = isToggleActive;
                initializeToggle();
                
                // Maintain current state position
                if (sendToggleThumb) {
                    hasDraggedDistance = false; // Reset drag flag
                    if (wasActive) {
                        sendToggleThumb.style.left = window.rightPosition + 'px';
                        sendToggleThumb.classList.add('active');
                        isToggleActive = true;
                    } else {
                        sendToggleThumb.style.left = window.leftPosition + 'px';
                        sendToggleThumb.classList.remove('active');
                        isToggleActive = false;
                    }
                }
            });



        // Phone number formatting (flexible for international numbers)
        const phoneInput = document.getElementById('phone');
        if (phoneInput) {
            phoneInput.addEventListener('input', function(e) {
                // Allow more flexible formatting for international numbers
                // Just ensure basic cleanup but don't force specific format
                let value = e.target.value;
                // Remove any characters that aren't numbers, spaces, parentheses, hyphens, or plus
                value = value.replace(/[^\d\s\(\)\-\+]/g, '');
                e.target.value = value;
            });
        }
    </script>
</body>
</html>